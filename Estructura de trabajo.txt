1. Tokenización de la medicación

    Entrada: Lista de medicamentos (nombre comercial, principio activo, o código estándar).
    Sugerencia:
        Decide un formato único (ej: todo en minúsculas, usa códigos ATC si puedes).
        Si el paciente toma varios fármacos, sepáralos con comas en el input.
        Construye un vocabulario (med_vocab.json) donde cada medicamento único tiene un índice.
        Tokeniza: Convierte la lista de medicamentos a una lista de índices según el vocabulario.
        Padding: Si hay menos medicamentos que el máximo esperado, rellena con 0s (<PAD>). Si hay más, corta.

Ejemplo:
Input: "abacavir, dolutegravir, lamivudina"
Tokenizado: [12, 7, 31, 0, 0] (si el máximo es 5 medicamentos por paciente)
2. Tokenización de los polimorfismos

    Entrada: Lista de polimorfismos presentes (ejemplo: CYP2B6*6, HLA-B*5701).
    Sugerencia:
        Define la lista de polimorfismos de interés (aquellos que afectan farmacocinética o riesgo).
        Usa siempre la misma notación para los polimorfismos (importante para reproducibilidad).
        Construye un vocabulario (mut_vocab.json) con todos los polimorfismos posibles.
        Tokeniza: Convierte la lista de polimorfismos del paciente en una lista de índices.
        Padding: Como antes, rellena con 0s si hay menos, o recorta si hay más de los esperados.

Ejemplo:
Input: "CYP2B6*6, HLA-B*5701"
Tokenizado: [3, 21, 0, 0, 0, 0, 0, 0, 0, 0] (si el máximo es 10 polimorfismos/paciente)
3. Recomendaciones generales para tu pipeline

    Entrenamiento:
        Extrae todos los polimorfismos y fármacos únicos de tu dataset para construir los vocabularios.
        Guarda esos vocabularios (med_vocab.json, mut_vocab.json) para usarlos en producción/inferencia.

    Inferencia:
        Carga los vocabularios guardados.
        Si te encuentras con un polimorfismo o fármaco no visto durante el entrenamiento, asigna el índice 0 (<PAD>/<UNK>).

    Padding:
        Usa tensorflow.keras.preprocessing.sequence.pad_sequences o implementa un simple .ljust de Python.
        El padding debe ser siempre post-padding (padding="post"), para que el modelo aprenda a ignorar ceros.

    Embeddings:
        Usa embeddings entrenables en Keras para que el modelo aprenda relaciones semánticas entre polimorfismos y fármacos.

4. Metodología de clases (ejemplo de clase preprocesadora)

Ya tienes una base, pero la estructura podría ser así:
Python

class PharmagenPreprocessor:
    def __init__(self, maxlen_mut=10, maxlen_drug=5):
        # ...
    def fit(self, df, mut_col, drug_col):
        # Genera vocabularios a partir del DF
    def transform(self, df, mut_col, drug_col):
        # Tokeniza usando vocabularios
    def save_vocabs(self, path1, path2):
        # Guarda vocabularios
    def load_vocabs(self, path1, path2):
        # Carga vocabularios

5. Bonus (consideraciones clínicas y de datos)

    Si hay polimorfismos o fármacos muy raros, considera agruparlos bajo un mismo token <RARE> para evitar ruido.
    Si algunos polimorfismos tienen alelos y variantes, asegúrate de normalizar la notación (usa siempre el mismo formato).
    Es fundamental documentar y versionar tus vocabularios para reproducibilidad clínica.
