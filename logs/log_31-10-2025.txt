2025-10-31 01:39:16,803 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 343, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 267, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 438, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 216, in optuna_objective
    n_alleles = get_num_alleles(data_loader)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 134, in get_num_alleles
    return len(data_loader.encoders["alleles"].classes_)
KeyError: 'alleles'
2025-10-31 01:39:56,644 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 343, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 267, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 438, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 271, in optuna_objective
    best_loss, best_accuracies_list = train_model(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\train.py", line 84, in train_model
    outputs = model(drug, genotype, gene, allele)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\model.py", line 154, in forward
    deep_input = torch.cat([drug_vec, geno_vec, gene_vec, allele_vec], dim=-1)
torch.AcceleratorError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

