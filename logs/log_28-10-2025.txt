2025-10-28 05:40:34,630 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 342, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 266, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 396, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 194, in optuna_objective
    model = DeepFM_PGenModel(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\model.py", line 142, in __init__
    self.output_heads[target_name] = nn.Linear(combined_dim, n_classes)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\container.py", line 546, in __setitem__
    self.add_module(key, module)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 654, in add_module
    raise KeyError(f"attribute '{name}' already exists")
KeyError: "attribute 'type' already exists"
2025-10-28 05:42:33,003 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 342, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 266, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 396, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 229, in optuna_objective
    best_loss, best_accuracies_list = train_model(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\train.py", line 91, in train_model
    outputs = model(drug, gene, genotype) #allele
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\model.py", line 147, in forward
    drug_vec = self.drug_emb(drug)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\sparse.py", line 192, in forward
    return F.embedding(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\functional.py", line 2546, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected tensor for argument #1 'indices' to have one of the following scalar types: Long, Int; but got torch.cuda.FloatTensor instead (while checking arguments for embedding)
2025-10-28 05:43:22,276 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 342, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 266, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 396, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 229, in optuna_objective
    best_loss, best_accuracies_list = train_model(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\train.py", line 91, in train_model
    outputs = model(drug, gene, genotype) #allele
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\model.py", line 147, in forward
    drug_vec = self.drug_emb(drug)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\sparse.py", line 192, in forward
    return F.embedding(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\functional.py", line 2546, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected tensor for argument #1 'indices' to have one of the following scalar types: Long, Int; but got torch.cuda.FloatTensor instead (while checking arguments for embedding)
2025-10-28 05:53:57,721 [CRITICAL] - Excepción no controlada:
Traceback (most recent call last):
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\rukia\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 342, in <module>
    main()
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\__main__.py", line 266, in main
    run_optuna_with_progress(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 396, in run_optuna_with_progress
    study.optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\study.py", line 490, in optimize
    _optimize(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 258, in _run_trial
    raise func_err
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\optuna\study\_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\optuna_train.py", line 229, in optuna_objective
    best_loss, best_accuracies_list = train_model(
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\train.py", line 91, in train_model
    outputs = model(drug, gene, genotype) #allele
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\pgen_model\model.py", line 147, in forward
    drug_vec = self.drug_emb(drug)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\modules\sparse.py", line 192, in forward
    return F.embedding(
  File "C:\Users\rukia\Documents\Master\Pharmagen\.env_pgen\lib\site-packages\torch\nn\functional.py", line 2546, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected tensor for argument #1 'indices' to have one of the following scalar types: Long, Int; but got torch.cuda.FloatTensor instead (while checking arguments for embedding)
